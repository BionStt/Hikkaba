@using System.Threading.Tasks
@using Hikkaba.Common.Constants
@using Hikkaba.Common.Entities
@using Hikkaba.Service
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@inject ICategoryService CategoryService

<div class="container">
    <div class="row">
        <div class="col-md-8">
            <div class="lead">
                [@Html.ActionLink(Defaults.BoardName, "Index", "Home")]
                [
                @{
                    var categories = await CategoryService.ListAsync(category => !category.IsHidden && !category.IsDeleted, category => category.Alias);
                    foreach (var category in categories)
                    {
                        @("/")
                        <a href="@Url.Action("Details", "Categories", new {categoryAlias = category.Alias})">@category.Alias</a>
                    }
                }
                ]

                [
                @if (SignInManager.IsSignedIn(User))
                {
                    <form asp-area="" asp-controller="Account" asp-action="LogOff" method="post" id="logoutForm" class="display-inline">
                        <a asp-area="" asp-controller="Manage" asp-action="Index" title="Manage">Hello @UserManager.GetUserName(User)!</a>
                        @("|")
                        <button type="submit" class="btn-link">Log off</button>
                    </form>
                }
                else
                {
                    @*<a asp-area="" asp-controller="Account" asp-action="Register">Register</a>
                        @("|")*@
                    <a asp-area="" asp-controller="Account" asp-action="Login">Log in</a>
                }
                ]
            </div>
        </div>
        <div class="col-md-4">
            <form asp-controller="Posts" asp-action="Search" method="get" class="form-group">
                <div class="input-group">
                    <input class="form-control search-input" type="text" name="query" placeholder="Search for..."><span class="input-group-btn"><button class="btn btn-default" type="submit"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button></span>
                </div>
            </form>
        </div>
    </div>
</div>